generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"

}

model User{
  id Int @id @default(autoincrement())
  fullName String
  email String @unique
  password String
  avatar String?
  phone String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  sessionsCreated SessionData[] @relation("OwnerSessions")
  progressRecords UserSessionProgress[]
  setting Setting?
}

model SessionData {
  id Int @id @default(autoincrement())
  title String
  type String
  duration Int
  difficulty String
  intensity Int
  description String
  image String
  ownerId Int?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  owner User? @relation("OwnerSessions",fields: [ownerId],references: [id])
  users UserSessionProgress[]
}

model Quote{
  id Int @id @default(autoincrement())
  quote String
  author String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model UserSessionProgress {
  id Int @id @default(autoincrement())
  userId Int
  sessionId Int
  progress Int 
  favorite Boolean @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId],references: [id])
  session SessionData @relation(fields: [sessionId],references: [id])

  @@index([userId], name: "idx_user_progress_user")
  @@index([sessionId], name: "idx_user_progress_session")
  @@unique([userId, sessionId], name: "unique_user_session") 
}


model Setting {
  id Int      @id @default(autoincrement())
  userId Int      @unique
  motivationalQuotes Boolean  @default(false)  
  vibrationEffects Boolean @default(false)     
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id])
}